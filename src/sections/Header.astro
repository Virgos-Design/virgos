---
import { Icon } from 'astro-icon';
import Logo from '~/components/atoms/Logo.astro';
import ToggleTheme from '~/components/core/ToggleTheme.astro';
import ToggleMenu from '~/components/core/ToggleMenu.astro';

import { getPermalink, getBlogPermalink, getHomePermalink } from '~/utils/permalinks';
---

<header id="page-header" class="">
	<a
		id="skip-to-main"
		href="#main-content"
		class="fixed inset-0 text-center bg-primary text-white border-b-2 border-white border-solid h-fit p-2 -translate-y-full focus:translate-y-0 ease-in-out duration-300"
		>Skip to Content</a
	>
	<nav id="menu" class="z-10 w-full absolute">
		<div class="max-w-7xl mx-auto px-6 py-8 md:px-12 xl:px-6">
			<div class="flex flex-wrap items-center justify-between py-2 gap-6 md:py-4 md:gap-0 relative">
				<div class="relative z-20 w-full flex justify-between lg:w-max md:px-0">
					<a id="brand" href="#" aria-label="logo" class="flex space-x-2 items-center">
						<div aria-hidden="true" class="flex space-x-1">
							<div class="h-4 w-4 rounded-full bg-gray-900 dark:bg-white"></div>
							<div class="h-6 w-2 bg-primary"></div>
						</div>
						<h1 class="sr-only">Virgos Design</h1>
						<Logo />
					</a>
					<ToggleMenu />
				</div>
				<div
					aria-hidden="true"
					class="fixed z-10 inset-0 h-screen w-screen bg-white/70 backdrop-blur-2xl origin-bottom scale-y-0 transition duration-500 peer-checked:origin-top peer-checked:scale-y-100 lg:hidden dark:bg-gray-900/70"
				>
				</div>
				<div
					class="flex-col z-20 flex-wrap gap-6 p-8 rounded-3xl border border-gray-100 bg-white shadow-2xl shadow-gray-600/10 justify-end w-full invisible opacity-0 translate-y-1 absolute top-full left-0 transition-all duration-300 scale-95 origin-top lg:relative lg:scale-100 lg:peer-checked:translate-y-0 lg:translate-y-0 lg:flex lg:flex-row lg:items-center lg:gap-0 lg:p-0 lg:bg-transparent lg:w-7/12 lg:visible lg:opacity-100 lg:border-none peer-checked:scale-100 peer-checked:opacity-100 peer-checked:visible lg:shadow-none dark:shadow-none dark:bg-gray-800 dark:border-gray-700"
				>
					<div class="text-gray-600 dark:text-gray-300 lg:pr-4 lg:w-auto w-full lg:pt-0">
						<ul class="tracking-wide font-medium lg:text-sm flex-col flex lg:flex-row gap-6 lg:gap-0">
							<li>
								<a href="/#about" class="block md:px-4 transition hover:text-primary">
									<span>About</span>
								</a>
							</li>
							<li>
								<a href="#" class="block md:px-4 transition hover:text-primary">
									<span>Services</span>
								</a>
							</li>
							<li>
								<a href="#" class="block md:px-4 transition hover:text-primary">
									<span>Process</span>
								</a>
							</li>
							<li>
								<a href="#" class="block md:px-4 transition hover:text-primary">
									<span>Pricing</span>
								</a>
							</li>
							<li>
								<a href="#" class="block md:px-4 transition hover:text-primary">
									<span>Blog</span>
								</a>
							</li>
						</ul>
					</div>

					<div class="mt-12 lg:mt-0">
						<a
							href="#"
							class="relative flex h-9 w-full items-center justify-center px-4 before:absolute before:inset-0 before:rounded-full before:bg-primary before:transition before:duration-300 hover:before:scale-105 active:duration-75 active:before:scale-95 sm:w-max"
						>
							<span class="relative text-sm font-semibold text-white">Get Started</span>
						</a>
					</div>
				</div>
			</div>
		</div>
	</nav>
</header>

<style>
	#toggle_nav:checked ~ div #hamburger #line {
		@apply rotate-45 translate-y-1.5;
	}

	#toggle_nav:checked ~ div #hamburger #line2 {
		@apply -rotate-45 -translate-y-1;
	}
</style>

<script>
	const header: HTMLElement = document.getElementById('page-header');
	const nav: HTMLElement = document.getElementById('menu');
	const menuToggle: HTMLElement = document.getElementById('toggle-menu');
	const brand: HTMLElement = document.getElementById('brand');
	const hero: HTMLElement = document.getElementById('hero');
	const page = document.documentElement;

	console.log("header", header)
	console.log("nav", nav);
	console.log("menuToggle", menuToggle);
	console.log("brand", brand)
  console.log("hero", hero)
	console.log("page", page)

	document.addEventListener('scroll', () => {
		const d = hero.offsetHeight - (page.scrollTop + header.offsetHeight);

		if (d < 0) {
			brand.classList.add('visible');
			brand.classList.remove('invisible');
			header.classList.add('backdrop-blur-md', 'bg-white/30', 'border-b', 'border-white');
			nav.classList.remove('text-white');
			nav.classList.add('text-[#321A81]');
			menuToggle.classList.remove('text-white');
			menuToggle.classList.add('text-[#321A81]');
		} else {
			brand.classList.add('invisible');
			brand.classList.remove('visible');
			header.classList.remove('backdrop-blur-md', 'bg-white/30', 'border-b', 'border-white');
			nav.classList.remove('text-[#321A81]');
			nav.classList.add('text-white');
			menuToggle.classList.remove('text-[#321A81]');
			menuToggle.classList.add('text-white');
		}
	});
</script>
